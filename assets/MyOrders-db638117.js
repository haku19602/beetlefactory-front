import{_ as w,K as C,r as i,o as S,P as A,Q as B,R as I,h as o,T as t,a3 as L,$ as n,a2 as d,ag as y,V as T,Z as v,a4 as M,a5 as N}from"./index-86e60c74.js";import{V as O}from"./VContainer-7c879897.js";import{a as P,V as f}from"./VRow-c4253e34.js";import{V as R,a as D}from"./VDataTable-281b6b7e.js";import{V as h}from"./VChip-da314b58.js";import"./VSelect-502aa59c.js";import"./VList-771963bf.js";import"./VDivider-e95f3cc1.js";const U=c=>(M("data-v-74f1f0b2"),c=c(),N(),c),q={style:{height:"100%"},class:"bg-back"},z=U(()=>v("h2",{class:"text-center mt-5 text-primary"},"我的訂單",-1)),E={class:"text-center pt-2"},K={__name:"MyOrders",setup(c){const{apiAuth:g}=L(),b=C(),u=i([]),V=i([{key:"createdAt",order:"desc"}]),l=i(1),k=[{title:"訂單編號",sortable:!1,key:"_id"},{title:"訂購日期",sortable:!0,key:"createdAt"},{title:"訂單金額",sortable:!0,key:"price",align:"center",value:r=>{const a=r.cart.reduce((s,e)=>s+e.quantity*e.product.price,0);return r.delivery==="黑貓"?a+110:r.delivery==="7-11 交貨便"?a+70:a}},{title:"付款狀態",sortable:!0,key:"paid",align:"center"},{title:"出貨狀態",sortable:!0,key:"shipped",align:"center"},{title:"完成訂單",sortable:!0,key:"done",align:"center"}],p=i(!0),m=i(0);return S(async()=>{var r,a;p.value=!0;try{const{data:s}=await g.get("/orders");m.value=s.result.length;const e=s.result.slice((l.value-1)*5,l.value*5);u.value.push(...e)}catch(s){const e=((a=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";b({text:e,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}p.value=!1}),(r,a)=>{const s=A("RouterLink");return B(),I("div",q,[o(O,null,{default:t(()=>[o(P,null,{default:t(()=>[o(f,null,{default:t(()=>[z]),_:1}),o(f,{cols:"12"},{default:t(()=>[o(R,{items:u.value,headers:k,"items-per-page":5,"sort-by":V.value,page:l.value,"onUpdate:page":[a[1]||(a[1]=e=>l.value=e),r.tableLoadItems],"items-length":m.value,loading:p.value,class:"bg-back"},{"item._id":t(({item:e})=>[o(s,{to:"/orders/"+e._id,class:"text-primary"},{default:t(()=>[n(d(e._id),1)]),_:2},1032,["to"])]),"item.createdAt":t(({item:e})=>[n(d(new Date(e.createdAt).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})),1)]),"item.price":t(({item:e})=>[n(" NT. "+d(e.cart.reduce((x,_)=>x+_.quantity*_.product.price,0)+(e.delivery==="黑貓"?110:e.delivery==="7-11 交貨便"?70:0)),1)]),"item.paid":t(({item:e})=>[o(h,{"append-icon":e.paid?"mdi-check":"mdi-close",variant:"text",class:y(e.paid?["text-primary"]:["text-secondary"])},{default:t(()=>[n(d(e.paid?"已付款":"未付款"),1)]),_:2},1032,["append-icon","class"])]),"item.shipped":t(({item:e})=>[o(h,{"append-icon":e.shipped?"mdi-check":"mdi-close",variant:"text",class:y(e.shipped?["text-primary"]:["text-secondary"])},{default:t(()=>[n(d(e.shipped?"已出貨":"未出貨"),1)]),_:2},1032,["append-icon","class"])]),"item.done":t(({item:e})=>[o(T,{color:"primary",variant:"flat",rounded:"",disabled:e.done||!e.paid},{default:t(()=>[n(d(e.done?"訂單已完成":"完成訂單"),1)]),_:2},1032,["disabled"])]),bottom:t(()=>[v("div",E,[o(D,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),length:2},null,8,["modelValue"])])]),_:2},1032,["items","sort-by","page","items-length","loading","onUpdate:page"])]),_:1})]),_:1})]),_:1})])}}},J=w(K,[["__scopeId","data-v-74f1f0b2"]]);export{J as default};
