import{K as w,N as B,L,r as N,o as P,P as I,Q as u,R as p,h as e,T as o,a3 as R,a6 as S,W as g,X as y,Y as T,U as $,S as z,a0 as A,Z as h,a2 as _,$ as D,V as x}from"./index-61bdf3a1.js";import{V as M}from"./VContainer-a4748d4a.js";import{a as V,V as l}from"./VRow-9215a6d5.js";import{b as U,V as j}from"./VList-f0b74b49.js";import{V as q}from"./VChip-30fdb8fe.js";import{V as E}from"./VDivider-b6542a92.js";import"./ssrBoot-c6cb0a50.js";const F={style:{height:"100%"},class:"bg-back"},K={key:0,class:"text-center text-grey-darken-1"},Q={class:"text-grey-darken-1"},tt={__name:"MyLikes",setup(W){const{apiAuth:m}=R(),i=w(),n=B(),k=L(),d=N([]),C=[{to:"/mysetting",text:"會員設定",icon:"mdi-cog"},{to:"/mylikes",text:"我的收藏",icon:"mdi-heart"},{to:"/myorders",text:"我的訂單",icon:"mdi-list-box"}],b=async a=>{var c,s;if(!n.isLogin){k.push("/login");return}try{const{data:t}=await m.patch("/users/cart",{product:a,quantity:1});n.cart=t.result,i({text:"已加入購物車！",showCloseButton:!1,snackbarProps:{timeout:1500,color:"back",location:"center"}})}catch(t){const r=((s=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";i({text:r,showCloseButton:!1,snackbarProps:{timeout:1500,color:"secondary",location:"center"}})}},v=async a=>{var c,s;if(!n.isLogin){k.push("/login");return}try{await m.patch("/users/likes",{product:a});const t=d.value.findIndex(f=>f.product._id===a);d.value.splice(t,1);const r=n.likes.findIndex(f=>f===a);n.likes.splice(r,1),i({text:"已取消收藏！",showCloseButton:!1,snackbarProps:{timeout:1e3,color:"back",location:"center"}})}catch(t){console.log(t);const r=((s=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";i({text:r,showCloseButton:!1,snackbarProps:{timeout:1e3,color:"secondary",location:"center"}})}};return P(async()=>{var a,c;try{const{data:s}=await m.get("/users/likes");d.value.push(...s.result)}catch(s){const t=((c=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:c.message)||"發生錯誤，請稍後再試";i({text:t,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}}),(a,c)=>{const s=I("RouterLink");return u(),p("div",F,[e(M,null,{default:o(()=>[e(V,{class:"justify-center pt-10"},{default:o(()=>[e(l,{cols:"5",sm:"4",md:"3",lg:"2"},{default:o(()=>[e(S,{class:"mx-auto",width:"200",flat:"0"},{default:o(()=>[e(U,{density:"compact",class:"bg-back"},{default:o(()=>[(u(),p(g,null,y(C,(t,r)=>e(j,{key:r,to:t.to,"prepend-icon":t.icon,title:t.text,color:"primary",rounded:"xl"},null,8,["to","prepend-icon","title"])),64))]),_:1})]),_:1})]),_:1}),e(l,{cols:"12",sm:"8",md:"9",lg:"10"},{default:o(()=>[T(n).likes.length===0?(u(),p("p",K,"----- 沒有收藏商品 -----")):$("",!0),(u(!0),p(g,null,y(d.value,t=>(u(),z(V,{key:t.product._id},{default:o(()=>[e(l,{cols:"6",lg:"3"},{default:o(()=>[e(s,{to:"/products/"+t.product._id},{default:o(()=>[e(A,{src:t.product.image,"aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(l,{cols:"6",lg:"9",class:"d-flex flex-column flex-lg-row"},{default:o(()=>[e(l,{lg:"4"},{default:o(()=>[h("h3",null,_(t.product.name),1),e(q,{density:"comfortable",class:"mt-2",variant:"outlined",color:"primary"},{default:o(()=>[D(_(t.product.category),1)]),_:2},1024)]),_:2},1024),e(l,{lg:"4"},{default:o(()=>[h("p",Q,"NT. "+_(t.product.price),1)]),_:2},1024),e(l,{lg:"4"},{default:o(()=>[e(x,{icon:"mdi-cart",size:"small",color:"primary",class:"me-3",onClick:r=>b(t.product._id)},null,8,["onClick"]),e(x,{icon:"mdi-heart-remove",size:"small",color:"secondary",onClick:r=>v(t.product._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(E,{class:"mx-3 my-3"})]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])}}};export{tt as default};
