import{L as _,K as k,N as C,r as S,Q as B,S as T,T as s,a3 as F,h as a,a6 as U,a7 as $,$ as c,a8 as M,Y as o,a9 as N,aa as m,V as q}from"./index-312f7d63.js";import{c as L,a as p,u as P,d as f,V as R}from"./index.esm-d9d440bf.js";import{V as A}from"./VContainer-e8ed2d20.js";import{V as K,a as Q}from"./VRow-94dabaa4.js";const G={__name:"LoginView",setup(Y){const{api:b}=F(),V=_(),d=k(),g=C(),n=S(!1),v=L({account:p().required("使用者帳號必填").min(4,"帳號名稱最少 4 字").max(20,"帳號名稱最多 20 字"),password:p().required("使用者密碼必填").min(4,"密碼最少 4 字").max(20,"密碼最多 20 字")}),{handleSubmit:x,isSubmitting:h}=P({validationSchema:v}),r=f("account"),u=f("password"),w=x(async i=>{var e,t;try{const{data:l}=await b.post("/users/login",{account:i.account,password:i.password});g.login(l.result),d({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"back",location:"bottom"}}),V.push("/")}catch(l){console.log(l);const y=((t=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";d({text:y,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}});return(i,e)=>(B(),T(A,{class:"d-flex align-center",style:{height:"90%"}},{default:s(()=>[a(Q,null,{default:s(()=>[a(K,{cols:"12",md:"6","offset-md":"3"},{default:s(()=>[a(U,{class:"mx-auto pa-8 pb-8 bg-back",elevation:"8","max-width":"448",rounded:"xl","align-self":"center"},{default:s(()=>[a($,{class:"pb-5"},{default:s(()=>[c("登入")]),_:1}),a(M,null,{default:s(()=>[a(R,{disabled:o(h),onSubmit:N(o(w),["prevent"])},{default:s(()=>[a(m,{class:"pb-3",label:"帳號",placeholder:"User name",hint:"4~20字 英文或數字",density:"compact",variant:"outlined",minlength:"4",maxlength:"20",counter:"","prepend-inner-icon":"mdi-account-outline",modelValue:o(r).value.value,"onUpdate:modelValue":e[0]||(e[0]=t=>o(r).value.value=t),"error-messages":o(r).errorMessage.value},null,8,["modelValue","error-messages"]),a(m,{class:"pb-3",label:"密碼",placeholder:"請輸入密碼",hint:"4~20字",density:"compact",variant:"outlined",minlength:"4",maxlength:"20",counter:"",type:n.value?"text":"password","prepend-inner-icon":"mdi-lock-outline","append-icon":n.value?"mdi-eye-off":"mdi-eye","onClick:append":e[1]||(e[1]=t=>n.value=!n.value),modelValue:o(u).value.value,"onUpdate:modelValue":e[2]||(e[2]=t=>o(u).value.value=t),"error-messages":o(u).errorMessage.value},null,8,["type","append-icon","modelValue","error-messages"]),a(q,{type:"submit",color:"secondary",rounded:"xl"},{default:s(()=>[c("Sign in")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{G as default};
