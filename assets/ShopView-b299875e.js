import{_ as P,N as B,K as C,L,c as I,P as T,Q as p,S as _,T as t,h as a,a6 as N,a0 as R,i as v,aG as A,a8 as D,$ as m,a2 as k,aH as O,aI as $,V as y,a1 as j,a4 as H,a5 as U,Z as g,a3 as w,r as W,o as q,an as E,R as V,W as F,X as G}from"./index-61bdf3a1.js";import{V as K}from"./VChip-30fdb8fe.js";import{V as M}from"./VDivider-b6542a92.js";import{V as Q}from"./VHover-2d7d60bf.js";import{g as X}from"./index-7d9a9c74.js";import{V as Z}from"./VContainer-a4748d4a.js";import{a as z,V as b}from"./VRow-9215a6d5.js";const J=s=>(H("data-v-aa0941f6"),s=s(),U(),s),Y=J(()=>g("h2",{class:"text-back sold-out pa-5"},[m("SOLD"),g("br"),m("OUT")],-1)),ee={__name:"ProductCard",props:["_id","category","description","image","name","price","sell","stock"],setup(s){const{apiAuth:f}=w(),c=B(),n=C(),i=L(),r=s,o=I(()=>c.likes.includes(r._id)),h=async()=>{var d,u;if(!c.isLogin){i.push("/login");return}try{const{data:e}=await f.patch("/users/cart",{product:r._id,quantity:1});c.cart=e.result,n({text:"已加入購物車！",showCloseButton:!1,snackbarProps:{timeout:1500,color:"back",location:"center"}})}catch(e){const l=((u=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:u.message)||"發生錯誤，請稍後再試";n({text:l,showCloseButton:!1,snackbarProps:{timeout:1500,color:"secondary",location:"center"}})}},x=async()=>{var d,u;if(!c.isLogin){i.push("/login");return}try{await f.patch("/users/likes",{product:r._id});const e=c.likes.findIndex(l=>l===r._id);e>-1?c.likes.splice(e,1):c.likes.push(r._id),n({text:o.value?"已加入收藏！":"已取消收藏！",showCloseButton:!1,snackbarProps:{timeout:1e3,color:"back",location:"center"}})}catch(e){console.log(e);const l=((u=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:u.message)||"發生錯誤，請稍後再試";n({text:l,showCloseButton:!1,snackbarProps:{timeout:1e3,color:"secondary",location:"center"}})}};return(d,u)=>{const e=T("RouterLink");return p(),_(Q,null,{default:t(({isHovering:l,props:S})=>[a(N,{flat:"0",rounded:"md",color:"back",class:"d-flex flex-column"},{default:t(()=>[a(e,{to:"/products/"+s._id,class:"text-decoration-none d-flex"},{default:t(()=>[a(R,v({src:s.image,cover:"","aspect-ratio":"1",class:{"on-hover":l}},S),{default:t(()=>[a(A,{"model-value":s.stock===0,contained:"",persistent:"",class:"align-center justify-center text-center",opacity:"0.5"},{default:t(()=>[Y]),_:1},8,["model-value"])]),_:2},1040,["src","class"])]),_:2},1032,["to"]),a(D,{class:"d-flex justify-space-between pb-1"},{default:t(()=>[m(k(s.name),1),a(K,{density:"comfortable",variant:"outlined",color:"primary"},{default:t(()=>[m(k(s.category),1)]),_:1})]),_:1}),a(O,null,{default:t(()=>[m("NT. "+k(s.price),1)]),_:1}),a(M,{class:"mx-3 mt-3"}),a($,null,{default:t(()=>[a(y,{"prepend-icon":"mdi-cart",color:"primary",rounded:"",onClick:h,disabled:s.stock<=0},{default:t(()=>[m("加入購物車")]),_:1},8,["disabled"]),a(j),o.value?(p(),_(y,{key:0,icon:"mdi-heart",density:"comfortable",color:"secondary",onClick:x})):(p(),_(y,{key:1,icon:"mdi-heart-outline",density:"comfortable",color:"secondary",onClick:x}))]),_:1})]),_:2},1024)]),_:1})}}},ae=P(ee,[["__scopeId","data-v-aa0941f6"]]),te={style:{height:"100%"},class:"bg-back"},se=g("h2",{class:"text-center text-primary"},"All",-1),ue={__name:"ShopView",setup(s){const{api:f}=w(),c=C(),n=W([]);return q(async()=>{var i,r;try{const{data:o}=await f.get("/products",{params:{itemsPerPage:-1}});n.value.push(...o.result.data),await E(),X.from(".product-card",{y:80,duration:1.2,ease:"linear",stagger:.2})}catch(o){console.log(o);const h=((r=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:r.message)||"發生錯誤，請稍後再試";c({text:h,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}}),(i,r)=>(p(),V("div",te,[a(Z,null,{default:t(()=>[a(z,null,{default:t(()=>[a(b,{cols:"12",class:"mt-6"},{default:t(()=>[se]),_:1}),(p(!0),V(F,null,G(n.value,o=>(p(),_(b,{cols:"6",md:"6",lg:"4",key:o._id},{default:t(()=>[a(ae,v(o,{class:"my-md-3 my-lg-5"}),null,16)]),_:2},1024))),128))]),_:1})]),_:1})]))}};export{ue as default};
