import{X as w,Z as B,Y as L,x as I,A as N,a0 as P,a1 as u,a2 as p,c as e,a4 as s,ad as R,ag as A,a6 as g,a7 as y,a8 as S,a5 as z,a3 as D,V as M,a9 as x,ac as _,aa as T,J as h}from"./index-3d960f8b.js";import{V as $}from"./VContainer-4fed0cc2.js";import{a as V,V as r}from"./VRow-d23250f5.js";import{b as j,V as q}from"./VList-4c0b4c5b.js";import{V as E}from"./VChip-bb3a691d.js";import{V as F}from"./VDivider-c82b0246.js";const J={style:{height:"100%"},class:"bg-back"},U={key:0,class:"text-center text-grey-darken-1"},X={class:"text-grey-darken-1"},W={__name:"MyLikes",setup(Y){const{apiAuth:m}=R(),i=w(),n=B(),k=L(),d=I([]),C=[{to:"/mysetting",text:"會員設定",icon:"mdi-cog"},{to:"/mylikes",text:"我的收藏",icon:"mdi-heart"},{to:"/myorders",text:"我的訂單",icon:"mdi-list-box"}],b=async a=>{var c,o;if(!n.isLogin){k.push("/login");return}try{const{data:t}=await m.patch("/users/cart",{product:a,quantity:1});n.cart=t.result,i({text:"已加入購物車！",showCloseButton:!1,snackbarProps:{timeout:1500,color:"back",location:"center"}})}catch(t){const l=((o=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";i({text:l,showCloseButton:!1,snackbarProps:{timeout:1500,color:"secondary",location:"center"}})}},v=async a=>{var c,o;if(!n.isLogin){k.push("/login");return}try{await m.patch("/users/likes",{product:a});const t=d.value.findIndex(f=>f.product._id===a);d.value.splice(t,1);const l=n.likes.findIndex(f=>f===a);n.likes.splice(l,1),i({text:"已取消收藏！",showCloseButton:!1,snackbarProps:{timeout:1e3,color:"back",location:"center"}})}catch(t){console.log(t);const l=((o=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";i({text:l,showCloseButton:!1,snackbarProps:{timeout:1e3,color:"secondary",location:"center"}})}};return N(async()=>{var a,c;try{const{data:o}=await m.get("/users/likes");d.value.push(...o.result)}catch(o){const t=((c=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:c.message)||"發生錯誤，請稍後再試";i({text:t,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}}),(a,c)=>{const o=P("RouterLink");return u(),p("div",J,[e($,null,{default:s(()=>[e(V,{class:"justify-center pt-10"},{default:s(()=>[e(r,{cols:"5",sm:"4",md:"3",lg:"2"},{default:s(()=>[e(A,{class:"mx-auto","max-width":"300",flat:"0"},{default:s(()=>[e(j,{density:"compact",class:"bg-back"},{default:s(()=>[(u(),p(g,null,y(C,(t,l)=>e(q,{key:l,to:t.to,"prepend-icon":t.icon,title:t.text,color:"primary",rounded:"xl"},null,8,["to","prepend-icon","title"])),64))]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",sm:"8",md:"9",lg:"10"},{default:s(()=>[S(n).likes.length===0?(u(),p("p",U,"----- 沒有收藏商品 -----")):z("",!0),(u(!0),p(g,null,y(d.value,t=>(u(),D(V,{key:t.product._id},{default:s(()=>[e(r,{cols:"6",lg:"3"},{default:s(()=>[e(o,{to:"/products/"+t.product._id},{default:s(()=>[e(M,{src:t.product.image,"aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(r,{cols:"6",lg:"9",class:"d-flex flex-column flex-lg-row"},{default:s(()=>[e(r,{lg:"4"},{default:s(()=>[x("h3",null,_(t.product.name),1),e(E,{density:"comfortable",class:"mt-2",variant:"outlined",color:"primary"},{default:s(()=>[T(_(t.product.category),1)]),_:2},1024)]),_:2},1024),e(r,{lg:"4"},{default:s(()=>[x("p",X,"NT. "+_(t.product.price),1)]),_:2},1024),e(r,{lg:"4"},{default:s(()=>[e(h,{icon:"mdi-cart",size:"small",color:"primary",class:"me-3",onClick:l=>b(t.product._id)},null,8,["onClick"]),e(h,{icon:"mdi-heart-remove",size:"small",color:"secondary",onClick:l=>v(t.product._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(F,{class:"mx-3 my-3"})]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])}}};export{W as default};
