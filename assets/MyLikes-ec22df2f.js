import{X as w,Z as B,Y as L,x as I,A as N,a0 as P,a1 as u,a2 as m,c as e,a4 as o,ad as R,ag as A,a6 as g,a7 as y,a8 as S,a5 as z,a3 as D,V as M,a9 as x,ac as _,aa as T,J as h}from"./index-7de24ab8.js";import{V as $}from"./VContainer-5cecc9e2.js";import{V}from"./VRow-34dcdaa6.js";import{V as l}from"./VCol-8840a17d.js";import{b as j,V as q}from"./VList-fe0b81e6.js";import{V as E}from"./VChip-febfb745.js";import{V as F}from"./VDivider-81fcde55.js";const J={style:{height:"100%"},class:"bg-back"},U={key:0,class:"text-center text-grey-darken-1"},X={class:"text-grey-darken-1"},tt={__name:"MyLikes",setup(Y){const{apiAuth:p}=R(),i=w(),n=B(),k=L(),d=I([]),C=[{to:"/mysetting",text:"會員設定",icon:"mdi-cog"},{to:"/mylikes",text:"我的收藏",icon:"mdi-heart"},{to:"/myorders",text:"我的訂單",icon:"mdi-list-box"}],b=async a=>{var c,s;if(!n.isLogin){k.push("/login");return}try{const{data:t}=await p.patch("/users/cart",{product:a,quantity:1});n.cart=t.result,i({text:"已加入購物車！",showCloseButton:!1,snackbarProps:{timeout:1500,color:"back",location:"center"}})}catch(t){const r=((s=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";i({text:r,showCloseButton:!1,snackbarProps:{timeout:1500,color:"secondary",location:"center"}})}},v=async a=>{var c,s;if(!n.isLogin){k.push("/login");return}try{await p.patch("/users/likes",{product:a});const t=d.value.findIndex(f=>f.product._id===a);d.value.splice(t,1);const r=n.likes.findIndex(f=>f===a);n.likes.splice(r,1),i({text:"已取消收藏！",showCloseButton:!1,snackbarProps:{timeout:1e3,color:"back",location:"center"}})}catch(t){console.log(t);const r=((s=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";i({text:r,showCloseButton:!1,snackbarProps:{timeout:1e3,color:"secondary",location:"center"}})}};return N(async()=>{var a,c;try{const{data:s}=await p.get("/users/likes");d.value.push(...s.result)}catch(s){const t=((c=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:c.message)||"發生錯誤，請稍後再試";i({text:t,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}}),(a,c)=>{const s=P("RouterLink");return u(),m("div",J,[e($,null,{default:o(()=>[e(V,{class:"justify-center pt-10"},{default:o(()=>[e(l,{cols:"5",sm:"4",md:"3",lg:"2"},{default:o(()=>[e(A,{class:"mx-auto","max-width":"300",flat:"0"},{default:o(()=>[e(j,{density:"compact",class:"bg-back"},{default:o(()=>[(u(),m(g,null,y(C,(t,r)=>e(q,{key:r,to:t.to,"prepend-icon":t.icon,title:t.text,color:"primary",rounded:"xl"},null,8,["to","prepend-icon","title"])),64))]),_:1})]),_:1})]),_:1}),e(l,{cols:"12",sm:"8",md:"9",lg:"10"},{default:o(()=>[S(n).likes.length===0?(u(),m("p",U,"----- 沒有收藏商品 -----")):z("",!0),(u(!0),m(g,null,y(d.value,t=>(u(),D(V,{key:t.product._id},{default:o(()=>[e(l,{cols:"6",lg:"3"},{default:o(()=>[e(s,{to:"/products/"+t.product._id},{default:o(()=>[e(M,{src:t.product.image,"aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(l,{cols:"6",lg:"9",class:"d-flex flex-column flex-lg-row"},{default:o(()=>[e(l,{lg:"4"},{default:o(()=>[x("h3",null,_(t.product.name),1),e(E,{density:"comfortable",class:"mt-2",variant:"outlined",color:"primary"},{default:o(()=>[T(_(t.product.category),1)]),_:2},1024)]),_:2},1024),e(l,{lg:"4"},{default:o(()=>[x("p",X,"NT. "+_(t.product.price),1)]),_:2},1024),e(l,{lg:"4"},{default:o(()=>[e(h,{icon:"mdi-cart",size:"small",color:"primary",class:"me-3",onClick:r=>b(t.product._id)},null,8,["onClick"]),e(h,{icon:"mdi-heart-remove",size:"small",color:"secondary",onClick:r=>v(t.product._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(F,{class:"mx-3 my-3"})]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])}}};export{tt as default};
