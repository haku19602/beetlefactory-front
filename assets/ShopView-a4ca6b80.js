import{_ as w,Z as S,X as V,Y as P,o as B,a0 as L,a1 as p,a3 as f,a4 as s,c as t,V as I,al as A,ai as T,aa as u,ac as h,am as N,an as R,J as y,ab as D,ag as O,ae as j,af as U,a9 as g,ad as v,x as $,A as q,ao as E,a2 as b,a6 as F,a7 as G,G as J}from"./index-fe19f0ca.js";import{V as M}from"./VChip-fbf9c447.js";import{V as W}from"./VDivider-b487ddc4.js";import{g as X}from"./index-7d9a9c74.js";import{V as Y}from"./VContainer-e3da55f4.js";import{a as Z,V as C}from"./VRow-701fd95c.js";const z=e=>(j("data-v-9160c023"),e=e(),U(),e),H=z(()=>g("h2",{class:"text-back sold-out pa-5"},[u("SOLD"),g("br"),u("OUT")],-1)),K={__name:"ProductCard",props:["_id","category","description","image","name","price","sell","stock"],setup(e){const{apiAuth:_}=v(),c=S(),n=V(),l=P(),r=e,o=B(()=>c.likes.includes(r._id)),k=async()=>{var i,d;if(!c.isLogin){l.push("/login");return}try{const{data:a}=await _.patch("/users/cart",{product:r._id,quantity:1});c.cart=a.result,n({text:"已加入購物車！",showCloseButton:!1,snackbarProps:{timeout:1500,color:"back",location:"center"}})}catch(a){const m=((d=(i=a==null?void 0:a.response)==null?void 0:i.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";n({text:m,showCloseButton:!1,snackbarProps:{timeout:1500,color:"secondary",location:"center"}})}},x=async()=>{var i,d;if(!c.isLogin){l.push("/login");return}try{await _.patch("/users/likes",{product:r._id});const a=c.likes.findIndex(m=>m===r._id);a>-1?c.likes.splice(a,1):c.likes.push(r._id),n({text:o.value?"已加入收藏！":"已取消收藏！",showCloseButton:!1,snackbarProps:{timeout:1e3,color:"back",location:"center"}})}catch(a){console.log(a);const m=((d=(i=a==null?void 0:a.response)==null?void 0:i.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";n({text:m,showCloseButton:!1,snackbarProps:{timeout:1e3,color:"secondary",location:"center"}})}};return(i,d)=>{const a=L("RouterLink");return p(),f(O,{flat:"0",rounded:"md",class:"product-card",color:"back"},{default:s(()=>[t(a,{to:"/products/"+e._id},{default:s(()=>[t(I,{src:e.image,cover:"","aspect-ratio":"1"},{default:s(()=>[t(A,{"model-value":e.stock===0,contained:"",persistent:"",class:"align-center justify-center text-center",opacity:"0.5"},{default:s(()=>[H]),_:1},8,["model-value"])]),_:1},8,["src"])]),_:1},8,["to"]),t(T,{class:"d-flex justify-space-between pb-1"},{default:s(()=>[u(h(e.name),1),t(M,{density:"comfortable",variant:"outlined",color:"primary"},{default:s(()=>[u(h(e.category),1)]),_:1})]),_:1}),t(N,null,{default:s(()=>[u("NT. "+h(e.price),1)]),_:1}),t(W,{class:"mx-3 mt-3"}),t(R,null,{default:s(()=>[t(y,{"prepend-icon":"mdi-cart",color:"primary",rounded:"",onClick:k,disabled:e.stock<=0},{default:s(()=>[u("加入購物車")]),_:1},8,["disabled"]),t(D),o.value?(p(),f(y,{key:0,icon:"mdi-heart",color:"secondary",onClick:x})):(p(),f(y,{key:1,icon:"mdi-heart-outline",color:"secondary",onClick:x}))]),_:1})]),_:1})}}},Q=w(K,[["__scopeId","data-v-9160c023"]]),aa={style:{height:"100%"},class:"bg-back"},ta=g("h2",{class:"text-center text-primary"},"All",-1),la={__name:"ShopView",setup(e){const{api:_}=v(),c=V(),n=$([]);return q(async()=>{var l,r;try{const{data:o}=await _.get("/products",{params:{itemsPerPage:-1}});n.value.push(...o.result.data),await E(),X.from(".product-card",{y:80,duration:1.2,ease:"linear",stagger:.2})}catch(o){console.log(o);const k=((r=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:r.message)||"發生錯誤，請稍後再試";c({text:k,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}}),(l,r)=>(p(),b("div",aa,[t(Y,null,{default:s(()=>[t(Z,null,{default:s(()=>[t(C,{cols:"12",class:"mt-6"},{default:s(()=>[ta]),_:1}),(p(!0),b(F,null,G(n.value,o=>(p(),f(C,{cols:"6",md:"6",lg:"4",key:o._id},{default:s(()=>[t(Q,J(o,{class:"my-md-3 my-lg-5"}),null,16)]),_:2},1024))),128))]),_:1})]),_:1})]))}};export{la as default};
